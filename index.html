<!DOCTYPE html>
<html lang="ja">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>メモ</title>
<meta name="apple-mobile-web-app-capable" content="yes">

<style>
body {
  font-family: -apple-system, BlinkMacSystemFont, sans-serif;
  margin: 0;
  display: flex;
  height: 100vh;
}
#list {
  width: 35%;
  background: #eee;
  padding: 10px;
  box-sizing: border-box;
  overflow-y: auto;
}
#editor {
  width: 65%;
  padding: 10px;
  box-sizing: border-box;
}
.item {
  background: #fff;
  padding: 8px;
  margin-bottom: 6px;
  border-radius: 6px;
  font-size: 14px;
}
.item.active {
  background: #cde4ff;
}
textarea {
  width: 100%;
  height: 85vh;
  font-size: 16px;
  border: none;
}
button {
  width: 100%;
  padding: 8px;
  margin-bottom: 8px;
}
</style>
</head>

<body>
<div id="list">
  <button id="add">＋ 新規メモ</button>
  <div id="items"></div>
</div>

<div id="editor">
  <textarea id="memo" placeholder="メモを書く"></textarea>
</div>

<script>
let memos = JSON.parse(localStorage.getItem("memos") || "[]");
let current = 0;

function save() {
  localStorage.setItem("memos", JSON.stringify(memos));
}

function renderList() {
  const items = document.getElementById("items");
  items.innerHTML = "";
  memos.forEach((m, i) => {
    const div = document.createElement("div");
    div.className = "item" + (i === current ? " active" : "");
    div.textContent = m.text.split("\n")[0] || "（無題）";
    div.onclick = () => {
      current = i;
      renderList();
      renderEditor();
    };
    items.appendChild(div);
  });
}

function renderEditor() {
  document.getElementById("memo").value = memos[current]?.text || "";
}

document.getElementById("add").onclick = () => {
  memos.unshift({ text: "" });
  current = 0;
  save();
  renderList();
  renderEditor();
};

document.getElementById("memo").addEventListener("input", e => {
  memos[current].text = e.target.value;
  save();
  renderList();
});

if (memos.length === 0) {
  memos.push({ text: "" });
}

renderList();
renderEditor();
</script>
</body>
</html>
