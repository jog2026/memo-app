<!DOCTYPE html>
<html lang="ja">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<title>Markdown Memo</title>

<!-- Markdown -->
<script src="https://cdn.jsdelivr.net/npm/marked/marked.min.js"></script>
<!-- XSS対策 -->
<script src="https://cdn.jsdelivr.net/npm/dompurify@3.0.6/dist/purify.min.js"></script>
<!-- Mermaid（安定版） -->
<script src="https://cdn.jsdelivr.net/npm/mermaid@9.4.3/dist/mermaid.min.js"></script>

<style>
body {
  font-family: -apple-system, BlinkMacSystemFont, sans-serif;
  margin: 0;
  padding: 10px;
}
textarea {
  width: 100%;
  height: 35vh;
  font-size: 16px;
}
#preview {
  margin-top: 10px;
  padding: 10px;
  background: #fff;
}
</style>
</head>

<body>

<textarea id="input">
# ロジックツリー

```mermaid
graph LR
A[結論] --> B[理由1]
A --> C[理由2]
B --> D[根拠1-1]
</textarea> <div id="preview"></div> <script> /* Mermaid 初期化（自動検出） */ mermaid.initialize({ startOnLoad: true }); function render() { let md = document.getElementById("input").value; // ```mermaid を div.mermaid に変換 md = md.replace(/```mermaid([\s\S]*?)```/g, function(_, code) { return `<div class="mermaid">${code}</div>`; }); // Markdown → HTML const html = marked.parse(md); // XSS除去 const safe = DOMPurify.sanitize(html, { ADD_TAGS: ['div'], ADD_ATTR: ['class'] }); document.getElementById("preview").innerHTML = safe; } document.getElementById("input").addEventListener("input", render); render(); </script> </body> </html> ```
